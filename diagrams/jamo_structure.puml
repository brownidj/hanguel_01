@startuml
skinparam monochrome true
skinparam backgroundColor white
skinparam classAttributeIconSize 0

' ==== Core types ====
class JamoBlock {
  +setContainer(c: BlockContainer)
  +container(): BlockContainer
}

class BlockContainer {
  - type: BlockType <<readOnly>>
  - segments: BlockSegment[3]
  - layoutStrategy: BlockLayoutStrategy
  --
  +BlockContainer(t: BlockType)  ' must be constructed with a type
  +getType(): BlockType
  +getSegments(): BlockSegment[3]
  +segment(role: SegmentRole): BlockSegment
  +applyLayout(): void
}

class BlockSegment {
  - role: SegmentRole <<readOnly>>
  --
  +BlockSegment(role: SegmentRole)
  +getRole(): SegmentRole
  ' Future content hooks (placeholders for L/V/T)
  +setInitial(consonantL)
  +setMedial(vowelV)
  +setFinal(consonantT?)  ' optional
}

enum BlockType {
  A_RightBranch
  B_TopBranch
  C_BottomBranch
  D_Horizontal
}

enum SegmentRole {
  Top
  Middle
  Bottom
}

' ==== Layout strategy (one per block type) ====
interface BlockLayoutStrategy {
  +apply(container: BlockContainer): void
}

class RightBranchLayout
class TopBranchLayout
class BottomBranchLayout
class HorizontalLayout

RightBranchLayout -up-|> BlockLayoutStrategy
TopBranchLayout -up-|> BlockLayoutStrategy
BottomBranchLayout -up-|> BlockLayoutStrategy
HorizontalLayout -up-|> BlockLayoutStrategy

' ==== Relationships ====
JamoBlock *-- "1" BlockContainer : contains
BlockContainer *-- "3" BlockSegment : composes
BlockContainer --> BlockType : has
BlockContainer o-- BlockLayoutStrategy : uses
BlockSegment --> SegmentRole : has

' ==== Constraints / Notes ====
note right of BlockContainer
  Invariant:
   - constructed with non-null BlockType
   - owns exactly 3 BlockSegments (Top, Middle, Bottom)
   - layoutStrategy matches type:
      A → RightBranchLayout
      B → TopBranchLayout
      C → BottomBranchLayout
      D → HorizontalLayout
end note
@enduml